{
  "metadata": {
    "id": "playwright-e2e-patterns-v1",
    "name": "Playwright E2E Testing Patterns",
    "category": "testing",
    "language": "typescript",
    "framework": "playwright",
    "description": "Production-ready Playwright E2E tests with Page Object Model, fixtures, visual regression, accessibility testing, and CI/CD integration",
    "tags": ["playwright", "e2e-testing", "page-object-model", "visual-regression", "accessibility", "ci-cd"],
    "quality_score": 91.0,
    "security_score": 82.0,
    "performance_score": 88.0,
    "maintainability_score": 93.0,
    "test_coverage": 95.0,
    "usage_count": 0,
    "success_rate": 0.0,
    "status": "approved",
    "created_at": "2025-10-04T20:00:00.000000",
    "updated_at": "2025-10-04T20:00:00.000000",
    "created_by": "template_enhancement_phase1",
    "persona": "qa_engineer"
  },
  "content": "// playwright.config.ts\nimport { defineConfig, devices } from '@playwright/test';\n\nexport default defineConfig({\n  testDir: './tests',\n  fullyParallel: true,\n  forbidOnly: !!process.env.CI,\n  retries: process.env.CI ? 2 : 0,\n  workers: process.env.CI ? 1 : undefined,\n  reporter: [\n    ['html'],\n    ['junit', { outputFile: 'test-results/junit.xml' }],\n    ['json', { outputFile: 'test-results/results.json' }],\n  ],\n  use: {\n    baseURL: process.env.BASE_URL || 'http://localhost:3000',\n    trace: 'on-first-retry',\n    screenshot: 'only-on-failure',\n    video: 'retain-on-failure',\n  },\n  projects: [\n    { name: 'chromium', use: { ...devices['Desktop Chrome'] } },\n    { name: 'firefox', use: { ...devices['Desktop Firefox'] } },\n    { name: 'webkit', use: { ...devices['Desktop Safari'] } },\n    { name: 'Mobile Chrome', use: { ...devices['Pixel 5'] } },\n    { name: 'Mobile Safari', use: { ...devices['iPhone 13'] } },\n  ],\n  webServer: {\n    command: 'npm run dev',\n    url: 'http://localhost:3000',\n    reuseExistingServer: !process.env.CI,\n  },\n});\n\n// tests/fixtures/test-fixtures.ts\nimport { test as base, expect } from '@playwright/test';\nimport { LoginPage } from '../pages/LoginPage';\nimport { DashboardPage } from '../pages/DashboardPage';\nimport { ApiClient } from '../utils/api-client';\n\ntype CustomFixtures = {\n  loginPage: LoginPage;\n  dashboardPage: DashboardPage;\n  authenticatedPage: DashboardPage;\n  apiClient: ApiClient;\n};\n\nexport const test = base.extend<CustomFixtures>({\n  loginPage: async ({ page }, use) => {\n    await use(new LoginPage(page));\n  },\n  \n  dashboardPage: async ({ page }, use) => {\n    await use(new DashboardPage(page));\n  },\n  \n  // Pre-authenticated fixture\n  authenticatedPage: async ({ page }, use) => {\n    const loginPage = new LoginPage(page);\n    await loginPage.goto();\n    await loginPage.login('test@example.com', 'password123');\n    \n    const dashboardPage = new DashboardPage(page);\n    await use(dashboardPage);\n  },\n  \n  apiClient: async ({ request }, use) => {\n    const client = new ApiClient(request);\n    await use(client);\n  },\n});\n\nexport { expect };\n\n// tests/pages/BasePage.ts\nimport { Page, Locator } from '@playwright/test';\n\nexport class BasePage {\n  constructor(protected page: Page) {}\n  \n  async goto(path: string = '') {\n    await this.page.goto(path);\n    await this.waitForPageLoad();\n  }\n  \n  async waitForPageLoad() {\n    await this.page.waitForLoadState('networkidle');\n  }\n  \n  async takeScreenshot(name: string) {\n    await this.page.screenshot({ path: `screenshots/${name}.png`, fullPage: true });\n  }\n  \n  async checkAccessibility() {\n    const accessibilityScanResults = await this.page.accessibility.snapshot();\n    return accessibilityScanResults;\n  }\n}\n\n// tests/pages/LoginPage.ts\nimport { Page, Locator } from '@playwright/test';\nimport { BasePage } from './BasePage';\n\nexport class LoginPage extends BasePage {\n  private readonly emailInput: Locator;\n  private readonly passwordInput: Locator;\n  private readonly submitButton: Locator;\n  private readonly errorMessage: Locator;\n  \n  constructor(page: Page) {\n    super(page);\n    this.emailInput = page.getByLabel('Email');\n    this.passwordInput = page.getByLabel('Password');\n    this.submitButton = page.getByRole('button', { name: 'Sign in' });\n    this.errorMessage = page.getByRole('alert');\n  }\n  \n  async goto() {\n    await super.goto('/login');\n  }\n  \n  async login(email: string, password: string) {\n    await this.emailInput.fill(email);\n    await this.passwordInput.fill(password);\n    await this.submitButton.click();\n    await this.page.waitForURL('**/dashboard');\n  }\n  \n  async getErrorMessage() {\n    return await this.errorMessage.textContent();\n  }\n  \n  async expectErrorMessage(message: string) {\n    await expect(this.errorMessage).toHaveText(message);\n  }\n}\n\n// tests/pages/DashboardPage.ts\nimport { Page, Locator } from '@playwright/test';\nimport { BasePage } from './BasePage';\n\nexport class DashboardPage extends BasePage {\n  private readonly welcomeMessage: Locator;\n  private readonly postsList: Locator;\n  private readonly createPostButton: Locator;\n  \n  constructor(page: Page) {\n    super(page);\n    this.welcomeMessage = page.getByRole('heading', { name: /welcome/i });\n    this.postsList = page.getByRole('list', { name: 'Posts' });\n    this.createPostButton = page.getByRole('button', { name: 'Create Post' });\n  }\n  \n  async goto() {\n    await super.goto('/dashboard');\n  }\n  \n  async createPost(title: string, content: string) {\n    await this.createPostButton.click();\n    await this.page.getByLabel('Title').fill(title);\n    await this.page.getByLabel('Content').fill(content);\n    await this.page.getByRole('button', { name: 'Submit' }).click();\n    await this.page.waitForResponse(res => res.url().includes('/api/posts') && res.status() === 201);\n  }\n  \n  async getPostCount() {\n    return await this.postsList.locator('li').count();\n  }\n}\n\n// tests/utils/api-client.ts\nimport { APIRequestContext } from '@playwright/test';\n\nexport class ApiClient {\n  constructor(private request: APIRequestContext) {}\n  \n  async login(email: string, password: string) {\n    const response = await this.request.post('/api/auth/login', {\n      data: { email, password },\n    });\n    return response.json();\n  }\n  \n  async createPost(token: string, data: { title: string; content: string }) {\n    const response = await this.request.post('/api/posts', {\n      headers: { Authorization: `Bearer ${token}` },\n      data,\n    });\n    return response.json();\n  }\n  \n  async getPosts(token: string) {\n    const response = await this.request.get('/api/posts', {\n      headers: { Authorization: `Bearer ${token}` },\n    });\n    return response.json();\n  }\n}\n\n// tests/e2e/auth.spec.ts\nimport { test, expect } from '../fixtures/test-fixtures';\n\ntest.describe('Authentication', () => {\n  test('should login successfully with valid credentials', async ({ loginPage, page }) => {\n    await loginPage.goto();\n    await loginPage.login('test@example.com', 'password123');\n    \n    await expect(page).toHaveURL(/.*dashboard/);\n    await expect(page.getByRole('heading', { name: /welcome/i })).toBeVisible();\n  });\n  \n  test('should show error with invalid credentials', async ({ loginPage }) => {\n    await loginPage.goto();\n    await loginPage.login('test@example.com', 'wrongpassword');\n    \n    await loginPage.expectErrorMessage('Invalid email or password');\n  });\n  \n  test('should validate email format', async ({ loginPage, page }) => {\n    await loginPage.goto();\n    await page.getByLabel('Email').fill('invalid-email');\n    await page.getByLabel('Password').fill('password123');\n    await page.getByRole('button', { name: 'Sign in' }).click();\n    \n    await expect(page.getByText('Please enter a valid email')).toBeVisible();\n  });\n});\n\n// tests/e2e/dashboard.spec.ts\nimport { test, expect } from '../fixtures/test-fixtures';\n\ntest.describe('Dashboard', () => {\n  test.use({ storageState: 'auth-state.json' }); // Reuse auth state\n  \n  test('should display user posts', async ({ authenticatedPage }) => {\n    await authenticatedPage.goto();\n    \n    const postCount = await authenticatedPage.getPostCount();\n    expect(postCount).toBeGreaterThan(0);\n  });\n  \n  test('should create a new post', async ({ authenticatedPage, page }) => {\n    await authenticatedPage.goto();\n    \n    const initialCount = await authenticatedPage.getPostCount();\n    await authenticatedPage.createPost('Test Post', 'Test Content');\n    \n    // Verify post was created\n    await expect(page.getByText('Test Post')).toBeVisible();\n    \n    const newCount = await authenticatedPage.getPostCount();\n    expect(newCount).toBe(initialCount + 1);\n  });\n});\n\n// tests/visual/visual-regression.spec.ts\nimport { test, expect } from '../fixtures/test-fixtures';\n\ntest.describe('Visual Regression', () => {\n  test('homepage screenshot comparison', async ({ page }) => {\n    await page.goto('/');\n    await expect(page).toHaveScreenshot('homepage.png', {\n      maxDiffPixels: 100,\n      threshold: 0.2,\n    });\n  });\n  \n  test('responsive layout - mobile', async ({ page }) => {\n    await page.setViewportSize({ width: 375, height: 667 });\n    await page.goto('/');\n    await expect(page).toHaveScreenshot('homepage-mobile.png');\n  });\n});\n\n// tests/accessibility/a11y.spec.ts\nimport { test, expect } from '@playwright/test';\nimport AxeBuilder from '@axe-core/playwright';\n\ntest.describe('Accessibility', () => {\n  test('should not have accessibility violations', async ({ page }) => {\n    await page.goto('/');\n    \n    const accessibilityScanResults = await new AxeBuilder({ page })\n      .withTags(['wcag2a', 'wcag2aa', 'wcag21a', 'wcag21aa'])\n      .analyze();\n    \n    expect(accessibilityScanResults.violations).toEqual([]);\n  });\n  \n  test('keyboard navigation', async ({ page }) => {\n    await page.goto('/login');\n    \n    await page.keyboard.press('Tab');\n    await expect(page.getByLabel('Email')).toBeFocused();\n    \n    await page.keyboard.press('Tab');\n    await expect(page.getByLabel('Password')).toBeFocused();\n    \n    await page.keyboard.press('Tab');\n    await expect(page.getByRole('button', { name: 'Sign in' })).toBeFocused();\n  });\n});\n\n// package.json scripts\n/*\n{\n  \"scripts\": {\n    \"test:e2e\": \"playwright test\",\n    \"test:e2e:ui\": \"playwright test --ui\",\n    \"test:e2e:debug\": \"playwright test --debug\",\n    \"test:e2e:headed\": \"playwright test --headed\",\n    \"test:e2e:report\": \"playwright show-report\",\n    \"test:visual:update\": \"playwright test --update-snapshots\"\n  }\n}\n*/",
  "variables": {},
  "dependencies": [
    "@playwright/test@^1.40.1",
    "@axe-core/playwright@^4.8.3"
  ],
  "workflow_context": {
    "typical_use_cases": [
      "E2E testing with Playwright",
      "Page Object Model pattern",
      "Visual regression testing",
      "Accessibility testing",
      "CI/CD integration"
    ],
    "team_composition": ["qa_engineer", "frontend_developer"],
    "estimated_time_minutes": 70,
    "prerequisites": [
      "Node.js and npm",
      "Application running locally",
      "Understanding of E2E testing",
      "Basic Playwright knowledge"
    ],
    "related_templates": [
      "cypress-e2e-framework",
      "visual-regression-testing",
      "accessibility-testing"
    ]
  }
}
