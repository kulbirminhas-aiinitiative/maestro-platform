{
  "metadata": {
    "id": "15b399d0-0b14-489e-9bff-62ef12e6445d",
    "name": "Docker Multi-Stage Build",
    "category": "infrastructure",
    "language": "dockerfile",
    "framework": "docker",
    "description": "Optimized multi-stage Dockerfile for Python application",
    "tags": [
      "docker",
      "dockerfile",
      "multi-stage",
      "python"
    ],
    "quality_score": 70.0,
    "security_score": 70.0,
    "performance_score": 70.0,
    "maintainability_score": 70.0,
    "test_coverage": 0.0,
    "usage_count": 0,
    "success_rate": 0.0,
    "status": "approved",
    "created_at": "2025-10-03T22:04:37.855377",
    "updated_at": "2025-10-03T22:04:37.855381",
    "created_by": "seed_script",
    "persona": "devops_engineer"
  },
  "content": "# Build stage\nFROM python:3.11-slim as builder\n\nWORKDIR /app\n\n# Install dependencies\nCOPY requirements.txt .\nRUN pip install --no-cache-dir --user -r requirements.txt\n\n# Runtime stage\nFROM python:3.11-slim\n\nWORKDIR /app\n\n# Copy dependencies from builder\nCOPY --from=builder /root/.local /root/.local\nENV PATH=/root/.local/bin:$PATH\n\n# Copy application\nCOPY . .\n\n# Create non-root user\nRUN useradd -m -u 1000 appuser && chown -R appuser:appuser /app\nUSER appuser\n\n# Health check\nHEALTHCHECK --interval=30s --timeout=3s --start-period=40s --retries=3 \\\n  CMD python -c \"import requests; requests.get('http://localhost:8000/health')\"\n\nEXPOSE 8000\n\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\", \"--port\", \"8000\"]",
  "variables": {},
  "dependencies": [],
  "workflow_context": {
    "typical_use_cases": [],
    "team_composition": [
      "devops_engineer"
    ],
    "estimated_time_minutes": 30
  }
}